# 2.4 项目架构理解

## 2.4.1 架构图

```plaintext
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   用户输入      │───▶│  AmritaCore      │───▶│  LLM 提供商     │
│                 │    │                  │    │                 │
└─────────────────┘    │  ┌─────────────┐ │    └─────────────────┘
                       │  │ ChatObject  │ │
                       │  └─────────────┘ │
                       │  ┌─────────────┐ │
                       │  │  配置       │ │
                       │  └─────────────┘ │
                       │  ┌─────────────┐ │
                       │  │   事件      │ │
                       │  └─────────────┘ │
                       │  ┌─────────────┐ │
                       │  │    工具     │ │
                       │  └─────────────┘ │
                       └──────────────────┘
```

## 2.4.2 核心组件关系

- **ChatObject**: 管理单个对话的主要交互点
- **配置**: 控制核心行为（上下文使用、工具调用等）
- **事件**: 允许挂钩到处理流水线
- **工具**: 通过外部函数扩展代理功能
- **内存模型**: 维护对话上下文和历史记录

## 2.4.3 数据流说明

1. 用户输入通过 ChatObject 进入
2. 配置确定处理行为
3. 输入被格式化并发送到 LLM
4. 事件可能会拦截并修改流程
5. 可能根据输入调用工具
6. 响应流式传输回用户
7. 内存使用新的对话状态进行更新