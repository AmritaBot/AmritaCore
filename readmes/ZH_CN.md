# AmritaCore - Proj.Amrita 智能体核心模块

## 项目概述

AmritaCore 是 Proj.Amrita 的智能体（Agent）核心模块，是一个轻量级的 Python 库，专注于提供可扩展、可维护的智能体核心实现。它作为项目的核心Agent组件，承担主要的逻辑或控制功能，为各种智能体应用场景提供坚实的基础。

## Why AmritaCore?

AmritaCore 旨在解决现代 AI 应用开发中的几个关键挑战：

1. **简化智能体开发**: 提供一套简洁的 API，让开发者能够快速构建和部署智能体应用，无需关心底层的复杂实现。

2. **灵活的配置系统**: 通过模块化的配置系统，开发者可以根据需求调整智能体的行为，包括上下文管理、工具调用来适应不同场景。

3. **可扩展的架构**: 设计上注重扩展性，支持工具集成、事件钩子等功能，允许开发者按需扩展智能体的能力。

4. **高效的上下文管理**: 内置智能记忆摘要功能，能够有效管理长对话历史，平衡上下文完整性和 Token 消耗。

5. **异步处理支持**: 原生异步处理，提供更好的用户体验。

6. **Every is a stream**: 异步流式消息输出设计，高效与显式的数据处理方式。

7. **Cookie安全检测**: 会在智能体输出时检测提示词是否泄露。

## 核心特性

### 配置系统

AmritaCore 提供了模块化的配置系统，主要分为两个部分：

#### FunctionConfig - 功能配置

- 可配置上下文使用策略，平衡 Token 消耗和上下文完整性
- 支持多种工具调用模式，包括 Agent 和 RAG 模式
- 提供多种推理模式，适应不同复杂度的任务需求
- 支持 MCP 客户端，便于与其他系统集成

#### LLMConfig - 大语言模型配置

- 内置智能记忆摘要功能，自动管理长对话历史
- 可配置 Token 计数模式，适应不同模型的需求
- 支持自动重试和超时控制，增强系统稳定性
- 提供会话级别的 Token 窗口管理

### 数据类型与对话管理

AmritaCore 定义了一套统一的数据类型和对话管理模式：

- **Message**: 统一的消息表示，包含角色和内容信息
- **MemoryModel**: 智能记忆模型，存储对话历史和摘要
- **ChatObject**: 核心对话处理单元，支持异步流式处理
- **ModelPreset/ModelConfig**: 模型配置系统，"Provider无关" 机制

ChatObject 是 AmritaCore 的核心组件之一，负责处理单个对话会话。它实现了异步流式响应处理，支持在处理过程中实时输出结果。ChatObject 通过队列机制管理响应流，确保响应的有序传递。它还集成了上下文管理和记忆限制功能，能够自动处理过长的对话历史。

### 事件系统

AmritaCore 提供了灵活的事件系统，允许开发者在处理流程的关键节点注入自定义逻辑：

- **PreCompletionEvent**: 在完成前触发，允许修改上下文或处理用户输入
- **CompletionEvent**: 在完成后触发，可用于处理最终响应或记录日志
- 事件系统通过 MatcherManager 管理和触发，支持动态注册和匹配规则

### 工具系统

AmritaCore 的工具系统支持外部工具集成：

- **装饰器注册**: 使用 `@on_tools` 装饰器轻松注册新工具
- **动态发现**: 工具元数据自动收集，支持运行时发现可用工具
- **条件启用**: 支持根据条件启用或禁用工具
- **类型安全**: 工具参数和返回值类型安全检查

### 扩展机制

AmritaCore 设计了灵活的扩展机制：

- **工具系统**: 支持外部工具集成，扩展智能体能力
- **事件钩子**: 允许在处理流程的关键节点注入自定义逻辑
- **协议适配器**: 支持不同 AI 模型的协议适配
- **MCP 客户端**: 轻松集成其他工具，轻松实现跨系统集成

### 安全机制

AmritaCore 内置了多重安全措施：

- **Cookie 检测**: 在智能体输出时检测提示词泄露
- **内容过滤**: 支持配置内容过滤机制
- **会话隔离**: 独立的会话状态管理，防止跨会话数据泄露
- **访问控制**: 支持配置访问权限和限制

## 适用场景

AmritaCore 适用于需要智能体能力的各种场景：

- 聊天机器人和虚拟助手
- 自动化工作流程
- 决策支持系统
- 智能客服系统
- 个性化推荐引擎

## 文档链接

请点击[这里](https://amrita-core.suggar.top)

